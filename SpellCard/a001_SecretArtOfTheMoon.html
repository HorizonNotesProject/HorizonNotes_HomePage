<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>【月の秘術】一覧 - HorizonNotes</title>
    
    <link rel="stylesheet" href="/css/style.css">

    <style>
        /* カード一覧コンテナ */
        .card-list-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
            padding: 20px;
        }

        /* カードリストのアイテム */
        .card-list-item {
            cursor: pointer;
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .card-list-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .card-list-item img {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
        }

        /* 詳細表示の切り替え */
        #card-list-view, #card-detail-view {
            display: none;
        }

        .active-view {
            display: block !important;
        }

        /* カード詳細ビューの調整 */
        .card-detail-main {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        /* 詳細ページで使用されているクラス */
        .spell-layout-grid {
            display: grid;
            grid-template-columns: 1fr 2fr; /* 画像と情報の2列レイアウト */
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .spell-layout-grid {
                grid-template-columns: 1fr; /* スマホでは縦並び */
            }
        }
        
        /* 必須項目の調整（元のHTML構造に合わせる） */
        .skill-box h4 { margin-top: 0; }
        .skill-prop { margin-bottom: 5px; }
        .skill-effect { 
            border: 1px dashed #ddd; 
            padding: 10px;
            margin-top: 10px;
        }

        /* グロッサリーツールチップの簡易スタイル (元のCSSがない場合を想定) */
        .glossary-tooltip {
            position: relative;
            cursor: help;
            border-bottom: 1px dotted #000;
        }
        .tooltip-text {
            display: none;
            position: absolute;
            background-color: #333;
            color: #fff;
            padding: 10px;
            border-radius: 5px;
            z-index: 10;
            width: 300px;
            left: 50%;
            transform: translateX(-50%);
            bottom: 120%;
            white-space: normal;
        }
        .glossary-tooltip:hover .tooltip-text {
            display: block;
        }
    </style>
</head>
<body>

    <div id="header-placeholder"></div>

    <main>
        <div id="card-list-view" class="active-view">
            <h2>【月の秘術】一覧 (8枚)</h2>
            <hr>
            <div id="card-list" class="card-list-container">
                </div>
        </div>

        <div id="card-detail-view" class="card-detail-main">
            <h2 id="detail-card-title"></h2>

            <div class="spell-layout-grid">
                
                <div class="spell-card-image">
                    <img id="detail-card-image" src="" alt="カード画像">
                    <p id="detail-rarity-text" class="rarity-text"></p>
                </div>

                <div class="spell-info-box">
                    <div class="skill-box">
                        <h4 id="detail-skill-name"></h4>
                        <div class="skill-prop"><strong>クラス:</strong> <span id="detail-class"></span></div>
                        <div class="skill-prop"><strong>コスト:</strong> <span id="detail-cost"></span></div>
                        <div class="skill-prop"><strong>タイミング:</strong> <span id="detail-timing"></span></div>
                        <div class="skill-effect">
                            <strong>効果:</strong><br>
                            <div id="detail-effect"></div>
                        </div>
                    </div>
                </div>

                <div class="flavor-text-box" style="grid-column: 1 / -1;">
                    <hr>
                    <p id="detail-flavor-text"></p>
                </div>

            </div>

            <hr>

            <div class="back-button-wrapper">
                <button id="back-to-list-button" class="back-button">← カード一覧へ戻る</button>
            </div>
        </div>
    </main>

    <div id="footer-placeholder"></div>

    <script>
        // --- カードデータ (13枚) ---
        // カードデータは、元のHTMLの構造に合わせて、必要な情報を抽出しています。
        const CARD_DATA = [
            {
                id: '001',
                name: '第一の秘術【図書館の門-ライブラリ・ゲート-】',
                rarity: 'アルティメットレア(UR)',
                image: '../images/cards/a001_card_001.png',
                class: '月の秘術',
                cost: '1',
                timing: '好きなタイミング',
                effect: `
                    <strong>【消滅】</strong><br>
                    このカードは発動後に<strong>ゲームから取り除かれ</strong>、バトル中に<strong>手札に加えることは出来ず</strong>、<strong>エーテル変換も出来ない</strong>。<br>
                    <strong>カードを３枚ドロー</strong>する。<br>
                    ドローしたスペルカードの<strong>コストを-2する</strong>。
                `,
                flavor: '<i>— 無限の書庫から、失われた真理を呼び覚ませ。</i>'
            },
            {
                id: '002',
                name: '第二の秘術【虚数の頁 -イマジナリー・ページ-】',
                rarity: 'アルティメットレア(UR)',
                image: '../images/cards/a001_card_002.png',
                class: '月の秘術',
                cost: '2',
                timing: 'カウンター[アストラル・コード]',
                effect: `
                <strong>【消滅】</strong>、<strong>【絶対効果】</strong><br>
                このカードは発動後に<strong>ゲームから取り除かれ</strong>、バトル中に<strong>手札に加えることは出来ず</strong>、<strong>エーテル変換も出来ない</strong>。<br>
                発動したアストラルコードの<strong>効果を【無効】にする</strong>。
                `,
                flavor: '<i>— 観測者が存在する限り、その魔導書は何度でも書き換えられる。</i>'
            },
            {
                id: '003',
                name: '第三の秘術【遡る時計 -ルナ・パラドクス-】',
                rarity: 'アルティメットレア(UR)',
                image: '../images/cards/a001_card_003.png',
                class: '月の秘術',
                cost: '3',
                timing: '好きなタイミング',
                effect: `
                <strong>【消滅】</strong><br>
                このカードは発動後に<strong>ゲームから取り除かれ</strong>、バトル中に<strong>手札に加えることは出来ず</strong>、<strong>エーテル変換も出来ない</strong>。<br>
                場に存在する<strong>タップ状態のアルカステラをアンタップに</strong>、<strong>アンタップ状態のアルカステラをタップ状態にする</strong>。
                `,
                flavor: '<i>— 一秒前へ。そのたった一瞬が、未来のすべてを変える。</i>'
            },
            {
                id: '004',
                name: '第四の秘術【沈黙の栞 -サイレント・ブックメーカー-】',
                rarity: 'アルティメットレア(UR)',
                image: '../images/cards/a001_card_004.png',
                class: '月の秘術',
                cost: '4',
                timing: '好きなタイミング',
                effect: `
                <strong>【消滅】</strong><br>
                このカードは発動後に<strong>ゲームから取り除かれ</strong>、バトル中に<strong>手札に加えることは出来ず</strong>、<strong>エーテル変換も出来ない</strong>。<br>
                <strong>お互いのアルカステラはこのターン、スペルカードを発動する事ができない</strong>。
                `,
                flavor: '<i>— 騒がしい知識の奔流を断ち切る、究極の静寂。</i>'
            },
            {
                id: '005',
                name: '第五の秘術【運命の誤記 -フェイト・ミスプリント-】',
                rarity: 'アルティメットレア(UR)',
                image: '../images/cards/a001_card_005.png',
                class: '月の秘術',
                cost: '5',
                timing: '好きなタイミング',
                effect: `
                <strong>【消滅】</strong><br>
                このカードは発動後に<strong>ゲームから取り除かれ</strong>、バトル中に<strong>手札に加えることは出来ず</strong>、<strong>エーテル変換も出来ない</strong>。<br>
                <strong>お互いにアルカステラを一体選択</strong>する。<br>
                そのアルカステラをこのバトル中、<strong>リーダーとして扱う</strong>。
                `,
                flavor: '<i>— わずか一文字の修正が、過去、現在、未来、すべての法則を破壊する。</i>'
            },
            {
                id: '006',
                name: '第六の秘術【封印の蔵書 -シールド・アーカイブ-】',
                rarity: 'アルティメットレア(UR)',
                image: '../images/cards/a001_card_006.png',
                class: '月の秘術',
                cost: '6',
                timing: '好きなタイミング',
                effect: `
                <strong>【消滅】</strong><strong>【継続:3】</strong><strong>【エーテル変換:1】</strong><br>
                このカードは発動後に<strong>ゲームから取り除かれ</strong>、バトル中に<strong>手札に加えることは出来ず</strong>、<strong>エーテル変換も出来ない</strong>。<br>
                このカードの継続効果が失われるまで、<br>
                あなたのアルカステラが受ける<strong>３点以上のダメージ</strong>、および<strong>【消失】ダメージは３点になる</strong>。
                `,
                flavor: '<i>— 蔵書庫の奥深く、誰も解読できない禁書に彼女の身は守られている。</i>'
            },
            {
                id: '007',
                name: '第七の秘術【失伝の言の葉 -グレーター・ディスペル・マジック-】',
                rarity: 'アルティメットレア(UR)',
                image: '../images/cards/a001_card_007.png',
                class: '月の秘術',
                cost: '7',
                timing: '好きなタイミング',
                effect: `
                <strong>【消滅】</strong><strong>【継続:10】</strong><strong>【エーテル変換:2】</strong><br>
                このカードは発動後に<strong>ゲームから取り除かれ</strong>、バトル中に<strong>手札に加えることは出来ず</strong>、<strong>エーテル変換も出来ない</strong>。<br>
                <strong>相手のアルカステラを1体選択</strong>する。<br>
                このカードの継続効果が失われるまで、そのアルカステラは<strong>アストラルコードを使うことが出来ない</strong>。
                `,
                flavor: `<i>— 【第七の秘術】。<br>
                    それは、他者の力を封じるのではなく、<br>
                    その魔法が最初から存在しなかったことにする究極の『打ち消し』だ。</i>`
            },
            {
                id: '008',
                name: '第八の秘術【綴始の白頁 -エナベイション-】',
                rarity: 'アルティメットレア(UR)',
                image: '../images/cards/a001_card_008.png',
                class: '月の秘術',
                cost: '8',
                timing: '好きなタイミング',
                effect: `
                <strong>【消滅】</strong><br>
                このカードは発動後に<strong>ゲームから取り除かれ</strong>、バトル中に<strong>手札に加えることは出来ず</strong>、<strong>エーテル変換も出来ない</strong>。<br>
                <strong>お互いの手札、エーテルエリアおよびセメタリーのカードをデッキに戻し</strong>、<strong>エーテル値を0にする</strong>。<br>
                その後、お互いの元々のエーテル値×５のダメージを<strong>お互いのすべてのアルカステラに与える</strong>。
                `,
                flavor: '<i>— その時、世界に色は失われ、ただ一つの白い頁（ページ）だけが残された。</i>'
            },
            
        ];


        // --- DOM要素の取得 ---
        const cardListView = document.getElementById('card-list-view');
        const cardDetailView = document.getElementById('card-detail-view');
        const cardListContainer = document.getElementById('card-list');
        const backToListButton = document.getElementById('back-to-list-button');

        // --- 詳細表示用の要素 ---
        const detailCardTitle = document.getElementById('detail-card-title');
        const detailCardImage = document.getElementById('detail-card-image');
        const detailRarityText = document.getElementById('detail-rarity-text');
        const detailSkillName = document.getElementById('detail-skill-name');
        const detailClass = document.getElementById('detail-class');
        const detailCost = document.getElementById('detail-cost');
        const detailTiming = document.getElementById('detail-timing');
        const detailEffect = document.getElementById('detail-effect');
        const detailFlavorText = document.getElementById('detail-flavor-text');


        /**
         * カード一覧を生成してHTMLに挿入する
         */
        function renderCardList() {
            CARD_DATA.forEach(card => {
                const listItem = document.createElement('div');
                listItem.className = 'card-list-item';
                listItem.dataset.cardId = card.id;
                
                // カード名と画像を表示
                listItem.innerHTML = `
                    <img src="${card.image}" alt="${card.name} カード" loading="lazy">
                    <p>No.${card.id} ${card.name}</p>
                    <p class="rarity-text">${card.rarity}</p>
                `;

                // クリックイベントを設定
                listItem.addEventListener('click', () => {
                    displayCardDetail(card.id);
                });

                cardListContainer.appendChild(listItem);
            });
        }

        /**
         * 指定されたカードIDの詳細を表示する
         * @param {string} cardId - 表示するカードのID
         */
        function displayCardDetail(cardId) {
            const card = CARD_DATA.find(c => c.id === cardId);
            if (!card) return;

            // データを詳細表示エリアに反映
            detailCardTitle.textContent = `No.${card.id}_${card.name}`;
            detailCardImage.src = card.image;
            detailCardImage.alt = `${card.name} カード`;
            detailRarityText.textContent = `レアリティ: ${card.rarity}`;
            detailSkillName.innerHTML = `<span class="sk-attack">${card.name}</span>`; // sk-attackクラスを付与
            detailClass.textContent = card.class;
            detailCost.textContent = card.cost;
            detailTiming.textContent = card.timing;
            detailEffect.innerHTML = card.effect; // 効果はHTMLを含むためinnerHTML
            detailFlavorText.innerHTML = card.flavor; // フレーバーテキストもHTMLを含む

            // ビューの切り替え
            cardListView.classList.remove('active-view');
            cardDetailView.classList.add('active-view');
            window.scrollTo(0, 0); // ページトップへ移動
        }

        /**
         * カード一覧表示に戻る
         */
        function backToList() {
            cardDetailView.classList.remove('active-view');
            cardListView.classList.add('active-view');
            window.scrollTo(0, 0);
        }

        // --- イベントリスナー ---
        backToListButton.addEventListener('click', backToList);

        // --- 初期化処理 ---
        document.addEventListener('DOMContentLoaded', () => {
            renderCardList();
            
            // --- ヘッダー・フッターを読み込む処理 ---
            // 既存のヘッダー・フッター読み込みスクリプトをそのまま残す
            fetch('/_includes/header.html')
                .then(response => {
                    if (!response.ok) throw new Error('Network response was not ok');
                    return response.text();
                })
                .then(data => {
                    document.getElementById('header-placeholder').innerHTML = data;
                })
                .catch(error => {
                    console.error('ヘッダーの読み込みに失敗しました:', error);
                });

            fetch('/_includes/footer.html')
                .then(response => {
                    if (!response.ok) throw new Error('Network response was not ok');
                    return response.text();
                })
                .then(data => {
                    document.getElementById('footer-placeholder').innerHTML = data;
                })
                .catch(error => {
                    console.error('フッターの読み込みに失敗しました:', error);
                });
        });
    </script>

</body>
</html>